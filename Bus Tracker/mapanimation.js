mapboxgl.accessToken = "pk.eyJ1IjoiYnV0dGZ1Y2tlcjMwMDAiLCJhIjoiY2t5OWZ5bXZpMDYxaTJydGZxMWRjZnp1MyJ9.hziNarxWwGKbVPziw2IxRA";
var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/satellite-streets-v11',
    center: [-90.031515602250408,29.964395418039182],
    zoom: 12
});

var marker = new mapboxgl.Marker()
.setLngLat([-90.031515602250408,29.964395418039182])
.addTo(map);

const busStops = [
  [-90.031515602250408,29.964395418039182],
  [-90.031675601913776,29.964435417697615],
  [-90.031935602347303,29.963515417257852],
  [-90.032205602362893,29.962535417537115],
  [-90.032505602438846,29.961625417361951],
  [-90.032495602067925,29.961545416973788],
  [-90.032555602640159,29.961465416542016],
  [-90.032805602011308,29.960605416484437],
  [-90.033095602235193,29.95964541632781],
  [-90.034105603029005,29.959865416159062],
  [-90.035095603300292,29.960085416578611],
  [-90.035965602734166,29.960295416178987],
  [-90.036925603865754,29.960525416754063],
  [-90.037445603910172,29.960645416900554],
  [-90.037895603354144,29.960745416356751],
  [-90.038775604213171,29.960935416574163],
  [-90.039585603862307,29.961105416756343],
  [-90.040335604388787,29.961275416967599],
  [-90.041145604176918,29.961465416236649],
  [-90.042035604951025,29.961665416330085],
  [-90.043125605337593,29.961915416937902],
  [-90.044005605298508,29.962105417130118],
  [-90.045745605484811,29.962505416701372],[-90.047535606033946,29.962915416420692],[-90.048465606328719,29.963125416506156],[-90.048715607040791,29.963185416717913],[-90.049815607070116,29.963435416745185],[-90.049945607244297,29.963005416599096],[-90.050145607564247,29.962355416445831],[-90.050215607522702,29.962305416300179],[-90.050295607120546,29.962285416183978],[-90.051195607500816,29.962215416295962],[-90.052225607839929,29.962125416705394],[-90.052745607880496,29.962085416235354],[-90.053885607577627,29.961995416664998],[-90.055025608160221,29.96187541627075],[-90.055975608466113,29.961785415932724],[-90.056255608276018,29.961785416040055],[-90.05654560858315,29.961795416342397],[-90.056605609033198,29.961665416271174],[-90.056685608750186,29.961545416515698],[-90.056815608560399,29.961415416049189],[-90.056935608969937,29.961245416513773],[-90.056975608881288,29.961415416203209],[-90.057065608966681,29.961515416033166],[-90.057635609325999,29.961885416145769],[-90.057975609631356,29.962125415820125],[-90.0580756094148,29.962025416588745],[-90.058565609708907,29.961455415997285],[-90.05865560963592,29.961345415697924],[-90.059265609081379,29.960695415799741],[-90.059645609690165,29.960255415551636],[-90.059965609494142,29.959915415826369],[-90.060285609328346,29.959565415932168],[-90.060665609276782,29.959135415753256],[-90.061125610152359,29.958615415668334],[-90.061355609865785,29.958345415171358],[-90.061695610380525,29.957965414834295],[-90.062065609964847,29.957545415341677],[-90.062435610578319,29.95712541482439],[-90.062785610346452,29.956725414732425],[-90.063175609944949,29.956305414876546],[-90.063505609896723,29.955945415006664],[-90.064215610766553,29.955145414476299],[-90.064305610379407,29.955005414839842],[-90.064415610409398,29.954865414035723],[-90.064715610977601,29.954205414156576],[-90.065145610587322,29.95325541453046],[-90.06557561067666,29.952315413761902],[-90.066015611381758,29.951265413396484],[-90.066625610755139,29.951635414128916],[-90.066785611535622,29.951465413598985],[-90.066165610451776,29.951045413193807],[-90.065975610776775,29.950905413238203],[-90.065315610394578,29.950475413810846],[-90.0651656110023,29.950655413649535],[-90.066015611381758,29.951265413396484]
];
var counter = 0;
function move() {
  setTimeout(() => {
    if (counter >= busStops.length) return;
    marker.setLngLat(busStops[counter]);
    counter++;
    move();
  }, 1000);
}

async function run(){
    const locations = await getBusLocations()
    console.log(new Date());
    console.log(locations);

    setTimeout(run, 15000);
    }
async function getBusLocations(){
    const url = 'https://gis.nola.gov/arcgis/rest/services/Transportation/PublicTransportationRoutes/MapServer/1/query?where=1%3D1&outFields=*&outSR=4326&f=json';
    const response = await fetch(url);
    const json     = await response.json();
    return json.data;
}
run();